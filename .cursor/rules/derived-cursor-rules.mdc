---
description: AI rules derived by SpecStory from the project AI interaction history
globs: *
---

## PROJECT OVERVIEW

## CODE STYLE

## FOLDER ORGANIZATION

The UV project file (`pyproject.toml` and `uv.lock`) and the `.venv` it creates should reside in the root directory of the project.

## TECH STACK

## PROJECT-SPECIFIC STANDARDS

When referencing file paths within the Medusa project, especially for UI files or other resources, use `os.path.join(constants.SRC_ROOT, ...)` to ensure paths are resolved correctly regardless of the current working directory. `constants.SRC_ROOT` should be defined in `src/constants.py` as `os.path.dirname(os.path.abspath(__file__))`.

In `gui_utils.py`, the `get_icon()` function must build icon paths using `os.path.join(constants.SRC_ROOT, constants.IMG_FOLDER, "icons", "svg", icon_name)` to ensure correct icon resolution relative to the package root.

When `accounts_manager.wrap_path()` is used to obtain config file paths, the code must guard against `wrap_path()` returning `False` (when there is no session). Callers should check `if path and os.path.isfile(path):` before calling `os.path.isfile()` or attempting to open the file. If `wrap_path()` returns `False`, a default path (e.g., `os.path.join(constants.SRC_ROOT, constants.DEFAULT_CONFIG_DIR, filename)`) should be used or loading/saving should be skipped.

## WORKFLOW & RELEASE RULES

When adding local editable dependencies with `uv add`, be aware of potential issues with platform-specific wheels. If an error arises indicating that a distribution can't be installed because it doesn't have a wheel for the current platform (e.g., Windows), investigate the dependency tree to identify the package causing the issue. Common causes include dependencies requesting packages like `pyqt5-qt5` instead of `PyQt5` on Windows. Solutions may involve using platform-specific dependencies or constraining the resolver to avoid problematic packages on certain platforms.

When adding local editable dependencies with `uv add`, and the dependency requires `PyQt5`, be aware that the resolver may attempt to use `pyqt5-qt5`, which does not provide pre-built Windows wheels. To avoid this issue, add `override-dependencies = ["PyQt5==5.15.11"]` (or a similar version known to bundle Qt for Windows) to the `[tool.uv]` section of `pyproject.toml`. This ensures that `uv` resolves to a `PyQt5` version that includes Windows wheels and does not depend on `pyqt5-qt5`.

## REFERENCE EXAMPLES

## PROJECT DOCUMENTATION & CONTEXT SYSTEM

## DEBUGGING

## FINAL DOs AND DON'Ts

When creating custom themes, especially a pink theme, for the workspace, the recommended approach is to add workspace-level color customizations. This involves modifying the workspace settings to include `workbench.colorCustomizations` and, optionally, `editor.tokenColorCustomizations`. This allows for overriding the current theme with custom colors to achieve the desired aesthetic without needing to create a full theme extension. Set `"workbench.colorTheme"` to a base theme (e.g., "Default Dark+" or "Dark+") to provide a consistent foundation for the customizations.